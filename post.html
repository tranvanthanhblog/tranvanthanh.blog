<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <title>Bài viết</title>
  <link rel="stylesheet" href="styles.css" />
</head>

<body class="dark">

  <div class="container">

    <button onclick="history.back()" class="btn">← Quay lại</button>

    <h1 id="title"></h1>

    <!-- MEDIA -->
    <div id="media" class="post-media"></div>

    <!-- CONTENT -->
    <div id="content" class="post-content"></div>

    <!-- COMMENT -->
    <h2>Bình luận</h2>

    <div class="comment-box">
      <input id="cmtInput" placeholder="Viết bình luận..." />
      <button id="btnSend">Gửi</button>
    </div>

    <div id="commentList"></div>

  </div>


<script src="db.js"></script>

<script>
const id = localStorage.getItem("viewPost");

const titleEl = document.getElementById("title");
const mediaBox = document.getElementById("media");
const contentEl = document.getElementById("content");
const commentList = document.getElementById("commentList");
const btnSend = document.getElementById("btnSend");
const cmtInput = document.getElementById("cmtInput");


/* ===== render ảnh / video ===== */
function renderMedia(url){
  if(!url) return "";

  const lower = url.toLowerCase();

  if(
    lower.includes(".mp4") ||
    lower.includes("firebase") ||
    lower.includes("storage")
  ){
    return `<video src="${url}" controls></video>`;
  }

  return `<img src="${url}"/>`;
}


/* ===== load post ===== */
DB.getPost(id).then(post => {

  titleEl.innerText = post.title;

  mediaBox.innerHTML = renderMedia(post.media);

  contentEl.innerHTML =
    post.content.replace(/\n/g,"<br>");

});


/* ===== comment ===== */
btnSend.onclick = () => {
  if(!cmtInput.value.trim()) return;

  const div = document.createElement("div");
  div.className = "comment-item";
  div.innerText = cmtInput.value;

  commentList.appendChild(div);

  cmtInput.value = "";
};
</script>

</body>
</html>
